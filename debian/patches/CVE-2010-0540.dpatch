#! /bin/sh /usr/share/dpatch/dpatch-run
# Description: fix cross-site request forgery in admin interface
# From: Drew Yao
# From: Jan Lieskovsky, Tim Waugh
# Bug: http://www.cups.org/str.php?L3593

@DPATCH@
diff -urNad cups-1.3.9~/cgi-bin/admin.c cups-1.3.9/cgi-bin/admin.c
--- cups-1.3.9~/cgi-bin/admin.c	2010-06-15 09:40:40.000000000 -0400
+++ cups-1.3.9/cgi-bin/admin.c	2010-06-15 09:40:57.000000000 -0400
@@ -110,7 +110,7 @@
   * See if we have form data...
   */
 
-  if (!cgiInitialize())
+  if (!cgiInitialize() || !cgiGetVariable("OP"))
   {
    /*
     * Nope, send the administration menu...
diff -urNad cups-1.3.9~/cgi-bin/cgi.h cups-1.3.9/cgi-bin/cgi.h
--- cups-1.3.9~/cgi-bin/cgi.h	2010-06-15 09:40:40.000000000 -0400
+++ cups-1.3.9/cgi-bin/cgi.h	2010-06-15 09:40:57.000000000 -0400
@@ -64,7 +64,7 @@
 extern void		cgiFreeSearch(void *search);
 extern const char	*cgiGetArray(const char *name, int element);
 extern void		cgiGetAttributes(ipp_t *request, const char *tmpl);
-extern char		*cgiGetCookie(const char *name, char *buf, int buflen);
+extern const char	*cgiGetCookie(const char *name);
 extern const cgi_file_t	*cgiGetFile(void);
 extern cups_array_t	*cgiGetIPPObjects(ipp_t *response, void *search);
 extern int		cgiGetSize(const char *name);
diff -urNad cups-1.3.9~/cgi-bin/ipp-var.c cups-1.3.9/cgi-bin/ipp-var.c
--- cups-1.3.9~/cgi-bin/ipp-var.c	2010-06-15 09:40:40.000000000 -0400
+++ cups-1.3.9/cgi-bin/ipp-var.c	2010-06-15 09:40:57.000000000 -0400
@@ -113,7 +113,7 @@
       */
 
       for (nameptr = name; (ch = getc(in)) != EOF;)
-        if (strchr("}]<>=! \t\n", ch))
+        if (strchr("}]<>=!~ \t\n", ch))
           break;
         else if (nameptr > name && ch == '?')
 	  break;
diff -urNad cups-1.3.9~/cgi-bin/template.c cups-1.3.9/cgi-bin/template.c
--- cups-1.3.9~/cgi-bin/template.c	2010-06-15 09:40:40.000000000 -0400
+++ cups-1.3.9/cgi-bin/template.c	2010-06-15 09:40:57.000000000 -0400
@@ -257,7 +257,7 @@
       uriencode = 0;
 
       for (s = name; (ch = getc(in)) != EOF;)
-        if (strchr("}]<>=! \t\n", ch))
+        if (strchr("}]<>=!~ \t\n", ch))
           break;
 	else if (s == name && ch == '%')
 	  uriencode = 1;
@@ -367,6 +367,20 @@
 
         continue;
       }
+      else if (name[0] == '$')
+      {
+       /*
+        * Insert cookie value or nothing if not defined.
+	*/
+
+        if ((value = cgiGetCookie(name + 1)) != NULL)
+	  outptr = value;
+	else
+	{
+	  outval[0] = '\0';
+	  outptr    = outval;
+	}
+      }
       else
       {
        /*
@@ -434,7 +448,14 @@
         * Test for existance...
 	*/
 
-        result     = cgiGetArray(name, element) != NULL && outptr[0];
+        if (name[0] == '?')
+	  result = cgiGetArray(name + 1, element) != NULL;
+	else if (name[0] == '#')
+	  result = cgiGetVariable(name + 1) != NULL;
+        else
+          result = cgiGetArray(name, element) != NULL;
+
+	result     = result && outptr[0];
 	compare[0] = '\0';
       }
       else
diff -urNad cups-1.3.9~/cgi-bin/var.c cups-1.3.9/cgi-bin/var.c
--- cups-1.3.9~/cgi-bin/var.c	2010-06-15 09:40:40.000000000 -0400
+++ cups-1.3.9/cgi-bin/var.c	2010-06-15 09:41:20.000000000 -0400
@@ -40,6 +40,14 @@
 /*#define DEBUG*/
 #include "cgi-private.h"
 #include <errno.h>
+#include <cups/md5.h>
+
+
+/*
+ * Session ID name
+ */
+
+#define CUPS_SID	"org.cups.sid"
 
 
 /*
@@ -59,6 +67,8 @@
  * Local globals...
  */
 
+static int		num_cookies = 0;/* Number of cookies */
+static cups_option_t	*cookies = NULL;/* Cookies */
 static int		form_count = 0,	/* Form variable count */
 			form_alloc = 0;	/* Number of variables allocated */
 static _cgi_var_t	*form_vars = NULL;
@@ -76,11 +86,13 @@
 static int		cgi_compare_variables(const _cgi_var_t *v1,
 			                      const _cgi_var_t *v2);
 static _cgi_var_t	*cgi_find_variable(const char *name);
+static void		cgi_initialize_cookies(void);
 static int		cgi_initialize_get(void);
 static int		cgi_initialize_multipart(const char *boundary);
 static int		cgi_initialize_post(void);
 static int		cgi_initialize_string(const char *data);
 static const char	*cgi_passwd(const char *prompt);
+static const char	*cgi_set_sid(void);
 static void		cgi_sort_variables(void);
 static void		cgi_unlink_file(void);
 
@@ -185,6 +197,17 @@
 
 
 /*
+ * 'cgiGetCookie()' - Get a cookie value.
+ */
+
+const char *				/* O - Value or NULL */
+cgiGetCookie(const char *name)		/* I - Name of cookie */
+{
+  return (cupsGetOption(name, num_cookies, cookies));
+}
+
+
+/*
  * 'cgiGetFile()' - Get the file (if any) that was submitted in the form.
  */
 
@@ -248,6 +271,8 @@
 {
   const char	*method;		/* Form posting method */
   const char	*content_type;		/* Content-Type of post data */
+  const char	*cups_sid_cookie,	/* SID cookie */
+		*cups_sid_form;		/* SID form variable */
 
 
  /*
@@ -272,6 +297,20 @@
 #endif /* DEBUG */
 
  /*
+  * Get cookies...
+  */
+
+  cgi_initialize_cookies();
+
+  if ((cups_sid_cookie = cgiGetCookie(CUPS_SID)) == NULL)
+  {
+    fputs("DEBUG: " CUPS_SID " cookie not found, initializing!\n", stderr);
+    cups_sid_cookie = cgi_set_sid();
+  }
+
+  fprintf(stderr, "DEBUG: " CUPS_SID " cookie is \"%s\"\n", cups_sid_cookie);
+
+ /*
   * Get the request method (GET or POST)...
   */
 
@@ -294,9 +333,27 @@
       boundary += 9;
 
     if (content_type && !strncmp(content_type, "multipart/form-data; ", 21))
-      return (cgi_initialize_multipart(boundary));
+    {
+      if (!cgi_initialize_multipart(boundary))
+        return (0);
+    }
+    else if (!cgi_initialize_post())
+      return (0);
+
+    if ((cups_sid_form = cgiGetVariable(CUPS_SID)) == NULL ||
+	strcmp(cups_sid_cookie, cups_sid_form))
+    {
+      if (cups_sid_form)
+	fprintf(stderr, "DEBUG: " CUPS_SID " form variable is \"%s\"\n",
+	        cups_sid_form);
+      else
+	fputs("DEBUG: " CUPS_SID " form variable is not present.\n", stderr);
+
+      cgiClearVariables();
+      return (0);
+    }
     else
-      return (cgi_initialize_post());
+      return (1);
   }
   else
     return (0);
@@ -375,6 +432,38 @@
 
 
 /*
+ * 'cgiSetCookie()' - Set a cookie value.
+ */
+
+void
+cgiSetCookie(const char *name,		/* I - Name */
+             const char *value,		/* I - Value */
+             const char *path,		/* I - Path (typically "/") */
+	     const char *domain,	/* I - Domain name */
+	     time_t     expires,	/* I - Expiration date (0 for session) */
+	     int        secure)		/* I - Require SSL */
+{
+  num_cookies = cupsAddOption(name, value, num_cookies, &cookies);
+
+  printf("Set-Cookie: %s=%s", name, value);
+  if (path)
+    printf("; path=%s", path);
+  if (domain)
+    printf("; domain=%s", domain);
+  if (expires)
+  {
+    char	date[256];		/* Date string */
+
+    printf("; expires=%s", httpGetDateString2(expires, date, sizeof(date)));
+  }
+  if (secure)
+    puts("; secure;");
+  else
+    puts(";");
+}
+
+
+/*
  * 'cgiSetSize()' - Set the array size.
  */
 
@@ -539,6 +628,96 @@
 
 
 /*
+ * 'cgi_initialize_cookies()' - Initialize cookies.
+ */
+
+static void
+cgi_initialize_cookies(void)
+{
+  const char	*cookie;		/* HTTP_COOKIE environment variable */
+  char		name[128],		/* Name string */
+		value[512],		/* Value string */
+		*ptr;			/* Pointer into name/value */
+
+
+  if ((cookie = getenv("HTTP_COOKIE")) == NULL)
+  {
+    fputs("DEBUG: HTTP_COOKIE not defined.\n", stderr);
+    return;
+  }
+
+  fprintf(stderr, "DEBUG: HTTP_COOKIE=\"%s\"\n", cookie);
+
+  while (*cookie)
+  {
+   /*
+    * Skip leading whitespace...
+    */
+
+    while (isspace(*cookie & 255))
+      cookie ++;
+    if (!*cookie)
+      break;
+
+   /*
+    * Copy the name...
+    */
+
+    for (ptr = name; *cookie && *cookie != '=';)
+      if (ptr < (name + sizeof(name) - 1))
+        *ptr++ = *cookie++;
+      else
+        break;
+
+    if (*cookie != '=')
+      break;
+
+    *ptr = '\0';
+    cookie ++;
+
+   /*
+    * Then the value...
+    */
+
+    if (*cookie == '\"')
+    {
+      for (cookie ++, ptr = value; *cookie && *cookie != '\"';)
+        if (ptr < (value + sizeof(value) - 1))
+	  *ptr++ = *cookie++;
+	else
+	  break;
+
+      if (*cookie == '\"')
+        cookie ++;
+    }
+    else
+    {
+      for (ptr = value; *cookie && *cookie != ';';)
+        if (ptr < (value + sizeof(value) - 1))
+	  *ptr++ = *cookie++;
+	else
+	  break;
+    }
+
+    if (*cookie == ';')
+      cookie ++;
+    else if (*cookie)
+      break;
+
+    *ptr = '\0';
+
+   /*
+    * Then add the cookie to an array as long as the name doesn't start with
+    * "$"...
+    */
+
+    if (name[0] != '$')
+      num_cookies = cupsAddOption(name, value, num_cookies, &cookies);
+  }
+}
+
+
+/*
  * 'cgi_initialize_get()' - Initialize form variables using the GET method.
  */
 
@@ -1012,6 +1191,46 @@
 
 
 /*
+ * 'cgi_set_sid()' - Set the CUPS session ID.
+ */
+
+static const char *			/* O - New session ID */
+cgi_set_sid(void)
+{
+  char			buffer[512],	/* SID data */
+			sid[33];	/* SID string */
+  _cups_md5_state_t	md5;		/* MD5 state */
+  unsigned char		sum[16];	/* MD5 sum */
+  const char		*remote_addr,	/* REMOTE_ADDR */
+			*server_name,	/* SERVER_NAME */
+			*server_port;	/* SERVER_PORT */
+
+
+  if ((remote_addr = getenv("REMOTE_ADDR")) == NULL)
+    remote_addr = "REMOTE_ADDR";
+  if ((server_name = getenv("SERVER_NAME")) == NULL)
+    server_name = "SERVER_NAME";
+  if ((server_port = getenv("SERVER_PORT")) == NULL)
+    server_port = "SERVER_PORT";
+
+  srand(time(NULL));
+  snprintf(buffer, sizeof(buffer), "%s:%s:%s:%02X%02X%02X%02X%02X%02X%02X%02X",
+           remote_addr, server_name, server_port,
+	   (unsigned)rand() & 255, (unsigned)rand() & 255,
+	   (unsigned)rand() & 255, (unsigned)rand() & 255,
+	   (unsigned)rand() & 255, (unsigned)rand() & 255,
+	   (unsigned)rand() & 255, (unsigned)rand() & 255);
+  _cupsMD5Init(&md5);
+  _cupsMD5Append(&md5, (unsigned char *)buffer, (int)strlen(buffer));
+  _cupsMD5Finish(&md5, sum);
+  
+  cgiSetCookie(CUPS_SID, httpMD5String(sum, sid), "/", NULL, 0, 0);
+
+  return (cupsGetOption(CUPS_SID, num_cookies, cookies));
+}
+
+
+/*
  * 'cgi_sort_variables()' - Sort all form variables for faster lookup.
  */
 
diff -urNad cups-1.3.9~/scheduler/client.c cups-1.3.9/scheduler/client.c
--- cups-1.3.9~/scheduler/client.c	2008-09-16 20:42:56.000000000 -0400
+++ cups-1.3.9/scheduler/client.c	2010-06-15 09:40:57.000000000 -0400
@@ -386,7 +386,9 @@
 #ifdef AF_INET6
     if (temp.addr.sa_family == AF_INET6)
     {
-      if (HostNameLookups)
+      if (httpAddrLocalhost(&temp))
+        strlcpy(con->servername, "localhost", sizeof(con->servername));
+      else if (HostNameLookups)
         httpAddrLookup(&temp, con->servername, sizeof(con->servername));
       else
         httpAddrString(&temp, con->servername, sizeof(con->servername));
@@ -397,7 +399,9 @@
 #endif /* AF_INET6 */
     if (temp.addr.sa_family == AF_INET)
     {
-      if (HostNameLookups)
+      if (httpAddrLocalhost(&temp))
+        strlcpy(con->servername, "localhost", sizeof(con->servername));
+      else if (HostNameLookups)
         httpAddrLookup(&temp, con->servername, sizeof(con->servername));
       else
         httpAddrString(&temp, con->servername, sizeof(con->servername));
diff -urNad cups-1.3.9~/templates/add-class.tmpl cups-1.3.9/templates/add-class.tmpl
--- cups-1.3.9~/templates/add-class.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Add Class</H2>
diff -urNad cups-1.3.9~/templates/add-printer.tmpl cups-1.3.9/templates/add-printer.tmpl
--- cups-1.3.9~/templates/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/add-rss-subscription.tmpl cups-1.3.9/templates/add-rss-subscription.tmpl
--- cups-1.3.9~/templates/add-rss-subscription.tmpl	2007-02-22 17:06:23.000000000 -0500
+++ cups-1.3.9/templates/add-rss-subscription.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">Add RSS Subscription</H2>
diff -urNad cups-1.3.9~/templates/admin.tmpl cups-1.3.9/templates/admin.tmpl
--- cups-1.3.9~/templates/admin.tmpl	2007-07-26 14:09:46.000000000 -0400
+++ cups-1.3.9/templates/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -55,6 +55,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Basic Server Settings:</B></P>
 
diff -urNad cups-1.3.9~/templates/choose-device.tmpl cups-1.3.9/templates/choose-device.tmpl
--- cups-1.3.9~/templates/choose-device.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/choose-make.tmpl cups-1.3.9/templates/choose-make.tmpl
--- cups-1.3.9~/templates/choose-make.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/choose-model.tmpl cups-1.3.9/templates/choose-model.tmpl
--- cups-1.3.9~/templates/choose-model.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/choose-serial.tmpl cups-1.3.9/templates/choose-serial.tmpl
--- cups-1.3.9~/templates/choose-serial.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/choose-uri.tmpl cups-1.3.9/templates/choose-uri.tmpl
--- cups-1.3.9~/templates/choose-uri.tmpl	2006-03-18 07:56:48.000000000 -0500
+++ cups-1.3.9/templates/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/de/add-class.tmpl cups-1.3.9/templates/de/add-class.tmpl
--- cups-1.3.9~/templates/de/add-class.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Klasse hinzuf&uuml;gen</H2>
diff -urNad cups-1.3.9~/templates/de/add-printer.tmpl cups-1.3.9/templates/de/add-printer.tmpl
--- cups-1.3.9~/templates/de/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/de/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/de/add-rss-subscription.tmpl cups-1.3.9/templates/de/add-rss-subscription.tmpl
--- cups-1.3.9~/templates/de/add-rss-subscription.tmpl	2007-07-27 17:19:56.000000000 -0400
+++ cups-1.3.9/templates/de/add-rss-subscription.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">RSS Subskription hinzuf&uuml;gen</H2>
diff -urNad cups-1.3.9~/templates/de/admin.tmpl cups-1.3.9/templates/de/admin.tmpl
--- cups-1.3.9~/templates/de/admin.tmpl	2007-08-15 15:33:36.000000000 -0400
+++ cups-1.3.9/templates/de/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -55,6 +55,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Grundlegende Servereinstellungen:</B></P>
 
diff -urNad cups-1.3.9~/templates/de/choose-device.tmpl cups-1.3.9/templates/de/choose-device.tmpl
--- cups-1.3.9~/templates/de/choose-device.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/de/choose-make.tmpl cups-1.3.9/templates/de/choose-make.tmpl
--- cups-1.3.9~/templates/de/choose-make.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/de/choose-model.tmpl cups-1.3.9/templates/de/choose-model.tmpl
--- cups-1.3.9~/templates/de/choose-model.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/de/choose-serial.tmpl cups-1.3.9/templates/de/choose-serial.tmpl
--- cups-1.3.9~/templates/de/choose-serial.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/de/choose-uri.tmpl cups-1.3.9/templates/de/choose-uri.tmpl
--- cups-1.3.9~/templates/de/choose-uri.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/de/edit-config.tmpl cups-1.3.9/templates/de/edit-config.tmpl
--- cups-1.3.9~/templates/de/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/de/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">Server Konfigurationsdatei</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/de/job-move.tmpl cups-1.3.9/templates/de/job-move.tmpl
--- cups-1.3.9~/templates/de/job-move.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/de/modify-class.tmpl cups-1.3.9/templates/de/modify-class.tmpl
--- cups-1.3.9~/templates/de/modify-class.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Klasse {printer_name} &auml;ndern</H2>
diff -urNad cups-1.3.9~/templates/de/modify-printer.tmpl cups-1.3.9/templates/de/modify-printer.tmpl
--- cups-1.3.9~/templates/de/modify-printer.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/de/samba-export.tmpl cups-1.3.9/templates/de/samba-export.tmpl
--- cups-1.3.9~/templates/de/samba-export.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Exportiere Drucker f&uuml;r Samba</H2>
diff -urNad cups-1.3.9~/templates/de/set-printer-options-header.tmpl cups-1.3.9/templates/de/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/de/set-printer-options-header.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/de/users.tmpl cups-1.3.9/templates/de/users.tmpl
--- cups-1.3.9~/templates/de/users.tmpl	2006-07-18 09:44:07.000000000 -0400
+++ cups-1.3.9/templates/de/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/edit-config.tmpl cups-1.3.9/templates/edit-config.tmpl
--- cups-1.3.9~/templates/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">Server Configuration File</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/es/add-class.tmpl cups-1.3.9/templates/es/add-class.tmpl
--- cups-1.3.9~/templates/es/add-class.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">A&ntilde;adir clase</H2>
diff -urNad cups-1.3.9~/templates/es/add-printer.tmpl cups-1.3.9/templates/es/add-printer.tmpl
--- cups-1.3.9~/templates/es/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/es/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/es/add-rss-subscription.tmpl cups-1.3.9/templates/es/add-rss-subscription.tmpl
--- cups-1.3.9~/templates/es/add-rss-subscription.tmpl	2007-08-15 15:33:36.000000000 -0400
+++ cups-1.3.9/templates/es/add-rss-subscription.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">A&ntilde;adir subscripci&oacute;n RSS</H2>
diff -urNad cups-1.3.9~/templates/es/admin.tmpl cups-1.3.9/templates/es/admin.tmpl
--- cups-1.3.9~/templates/es/admin.tmpl	2007-08-15 15:33:36.000000000 -0400
+++ cups-1.3.9/templates/es/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -55,6 +55,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Configuraci&oacute;n b&aacute;sica del servidor:</B></P>
 
diff -urNad cups-1.3.9~/templates/es/choose-device.tmpl cups-1.3.9/templates/es/choose-device.tmpl
--- cups-1.3.9~/templates/es/choose-device.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/es/choose-make.tmpl cups-1.3.9/templates/es/choose-make.tmpl
--- cups-1.3.9~/templates/es/choose-make.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/es/choose-model.tmpl cups-1.3.9/templates/es/choose-model.tmpl
--- cups-1.3.9~/templates/es/choose-model.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/es/choose-serial.tmpl cups-1.3.9/templates/es/choose-serial.tmpl
--- cups-1.3.9~/templates/es/choose-serial.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/es/choose-uri.tmpl cups-1.3.9/templates/es/choose-uri.tmpl
--- cups-1.3.9~/templates/es/choose-uri.tmpl	2006-03-18 07:56:48.000000000 -0500
+++ cups-1.3.9/templates/es/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/es/edit-config.tmpl cups-1.3.9/templates/es/edit-config.tmpl
--- cups-1.3.9~/templates/es/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/es/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">Archivo de configuraci&oacute;n del servidor</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/es/job-move.tmpl cups-1.3.9/templates/es/job-move.tmpl
--- cups-1.3.9~/templates/es/job-move.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/es/modify-class.tmpl cups-1.3.9/templates/es/modify-class.tmpl
--- cups-1.3.9~/templates/es/modify-class.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Modificar clase {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/es/modify-printer.tmpl cups-1.3.9/templates/es/modify-printer.tmpl
--- cups-1.3.9~/templates/es/modify-printer.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/es/samba-export.tmpl cups-1.3.9/templates/es/samba-export.tmpl
--- cups-1.3.9~/templates/es/samba-export.tmpl	2007-08-15 15:33:36.000000000 -0400
+++ cups-1.3.9/templates/es/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Exportar impresoras a Samba</H2>
diff -urNad cups-1.3.9~/templates/es/set-printer-options-header.tmpl cups-1.3.9/templates/es/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/es/set-printer-options-header.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/es/users.tmpl cups-1.3.9/templates/es/users.tmpl
--- cups-1.3.9~/templates/es/users.tmpl	2006-03-13 08:34:24.000000000 -0500
+++ cups-1.3.9/templates/es/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/et/add-class.tmpl cups-1.3.9/templates/et/add-class.tmpl
--- cups-1.3.9~/templates/et/add-class.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Klassi lisamine</H2>
diff -urNad cups-1.3.9~/templates/et/add-printer.tmpl cups-1.3.9/templates/et/add-printer.tmpl
--- cups-1.3.9~/templates/et/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/et/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/et/admin.tmpl cups-1.3.9/templates/et/admin.tmpl
--- cups-1.3.9~/templates/et/admin.tmpl	2007-03-19 12:01:28.000000000 -0400
+++ cups-1.3.9/templates/et/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -59,6 +59,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Serveri põhiseadistused:</B></P>
 
diff -urNad cups-1.3.9~/templates/et/choose-device.tmpl cups-1.3.9/templates/et/choose-device.tmpl
--- cups-1.3.9~/templates/et/choose-device.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/et/choose-make.tmpl cups-1.3.9/templates/et/choose-make.tmpl
--- cups-1.3.9~/templates/et/choose-make.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/et/choose-model.tmpl cups-1.3.9/templates/et/choose-model.tmpl
--- cups-1.3.9~/templates/et/choose-model.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/et/choose-serial.tmpl cups-1.3.9/templates/et/choose-serial.tmpl
--- cups-1.3.9~/templates/et/choose-serial.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/et/choose-uri.tmpl cups-1.3.9/templates/et/choose-uri.tmpl
--- cups-1.3.9~/templates/et/choose-uri.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/et/edit-config.tmpl cups-1.3.9/templates/et/edit-config.tmpl
--- cups-1.3.9~/templates/et/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/et/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">Serveri seadistustefail</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/et/modify-class.tmpl cups-1.3.9/templates/et/modify-class.tmpl
--- cups-1.3.9~/templates/et/modify-class.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Klassi {printer_name} muutmine</H2>
diff -urNad cups-1.3.9~/templates/et/modify-printer.tmpl cups-1.3.9/templates/et/modify-printer.tmpl
--- cups-1.3.9~/templates/et/modify-printer.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/et/samba-export.tmpl cups-1.3.9/templates/et/samba-export.tmpl
--- cups-1.3.9~/templates/et/samba-export.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Printerite eksport Sambasse</H2>
diff -urNad cups-1.3.9~/templates/et/set-printer-options-header.tmpl cups-1.3.9/templates/et/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/et/set-printer-options-header.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/et/users.tmpl cups-1.3.9/templates/et/users.tmpl
--- cups-1.3.9~/templates/et/users.tmpl	2006-10-02 12:02:23.000000000 -0400
+++ cups-1.3.9/templates/et/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/fr/add-class.tmpl cups-1.3.9/templates/fr/add-class.tmpl
--- cups-1.3.9~/templates/fr/add-class.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Ajouter une classe</H2>
diff -urNad cups-1.3.9~/templates/fr/add-printer.tmpl cups-1.3.9/templates/fr/add-printer.tmpl
--- cups-1.3.9~/templates/fr/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/fr/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/fr/admin.tmpl cups-1.3.9/templates/fr/admin.tmpl
--- cups-1.3.9~/templates/fr/admin.tmpl	2008-10-09 13:35:22.000000000 -0400
+++ cups-1.3.9/templates/fr/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -55,6 +55,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Paramètres de base du serveur :</B></P>
 
diff -urNad cups-1.3.9~/templates/fr/choose-device.tmpl cups-1.3.9/templates/fr/choose-device.tmpl
--- cups-1.3.9~/templates/fr/choose-device.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/fr/choose-make.tmpl cups-1.3.9/templates/fr/choose-make.tmpl
--- cups-1.3.9~/templates/fr/choose-make.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/fr/choose-model.tmpl cups-1.3.9/templates/fr/choose-model.tmpl
--- cups-1.3.9~/templates/fr/choose-model.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/fr/choose-serial.tmpl cups-1.3.9/templates/fr/choose-serial.tmpl
--- cups-1.3.9~/templates/fr/choose-serial.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/fr/choose-uri.tmpl cups-1.3.9/templates/fr/choose-uri.tmpl
--- cups-1.3.9~/templates/fr/choose-uri.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/fr/edit-config.tmpl cups-1.3.9/templates/fr/edit-config.tmpl
--- cups-1.3.9~/templates/fr/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/fr/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">Ficher de configuration du serveur</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/fr/job-move.tmpl cups-1.3.9/templates/fr/job-move.tmpl
--- cups-1.3.9~/templates/fr/job-move.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/fr/modify-class.tmpl cups-1.3.9/templates/fr/modify-class.tmpl
--- cups-1.3.9~/templates/fr/modify-class.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Modifier la classe {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/fr/modify-printer.tmpl cups-1.3.9/templates/fr/modify-printer.tmpl
--- cups-1.3.9~/templates/fr/modify-printer.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/fr/samba-export.tmpl cups-1.3.9/templates/fr/samba-export.tmpl
--- cups-1.3.9~/templates/fr/samba-export.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Exporter des imprimantes vers SAMBA</H2>
diff -urNad cups-1.3.9~/templates/fr/set-printer-options-header.tmpl cups-1.3.9/templates/fr/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/fr/set-printer-options-header.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/fr/users.tmpl cups-1.3.9/templates/fr/users.tmpl
--- cups-1.3.9~/templates/fr/users.tmpl	2007-02-05 14:37:04.000000000 -0500
+++ cups-1.3.9/templates/fr/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/he/add-class.tmpl cups-1.3.9/templates/he/add-class.tmpl
--- cups-1.3.9~/templates/he/add-class.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">הוסף מחלקה</H2>
diff -urNad cups-1.3.9~/templates/he/add-printer.tmpl cups-1.3.9/templates/he/add-printer.tmpl
--- cups-1.3.9~/templates/he/add-printer.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">הוסף מדפסת חדשה</H2>
diff -urNad cups-1.3.9~/templates/he/admin.tmpl cups-1.3.9/templates/he/admin.tmpl
--- cups-1.3.9~/templates/he/admin.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -59,6 +59,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>הגדרות שרת בסיסיות:</B></P>
 
diff -urNad cups-1.3.9~/templates/he/choose-device.tmpl cups-1.3.9/templates/he/choose-device.tmpl
--- cups-1.3.9~/templates/he/choose-device.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/he/choose-make.tmpl cups-1.3.9/templates/he/choose-make.tmpl
--- cups-1.3.9~/templates/he/choose-make.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/he/choose-model.tmpl cups-1.3.9/templates/he/choose-model.tmpl
--- cups-1.3.9~/templates/he/choose-model.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/he/choose-serial.tmpl cups-1.3.9/templates/he/choose-serial.tmpl
--- cups-1.3.9~/templates/he/choose-serial.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/he/choose-uri.tmpl cups-1.3.9/templates/he/choose-uri.tmpl
--- cups-1.3.9~/templates/he/choose-uri.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/he/edit-config.tmpl cups-1.3.9/templates/he/edit-config.tmpl
--- cups-1.3.9~/templates/he/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/he/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">קובץ הגדרות של השרת</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25" dir=ltr>{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/he/job-move.tmpl cups-1.3.9/templates/he/job-move.tmpl
--- cups-1.3.9~/templates/he/job-move.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/he/modify-class.tmpl cups-1.3.9/templates/he/modify-class.tmpl
--- cups-1.3.9~/templates/he/modify-class.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">שנה מחלקה {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/he/modify-printer.tmpl cups-1.3.9/templates/he/modify-printer.tmpl
--- cups-1.3.9~/templates/he/modify-printer.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/he/samba-export.tmpl cups-1.3.9/templates/he/samba-export.tmpl
--- cups-1.3.9~/templates/he/samba-export.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">ייצא מדפסות ל Samba</H2>
diff -urNad cups-1.3.9~/templates/he/set-printer-options-header.tmpl cups-1.3.9/templates/he/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/he/set-printer-options-header.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/he/users.tmpl cups-1.3.9/templates/he/users.tmpl
--- cups-1.3.9~/templates/he/users.tmpl	2007-04-02 10:31:49.000000000 -0400
+++ cups-1.3.9/templates/he/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/id/add-class.tmpl cups-1.3.9/templates/id/add-class.tmpl
--- cups-1.3.9~/templates/id/add-class.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Tambah Kelas</H2>
diff -urNad cups-1.3.9~/templates/id/add-printer.tmpl cups-1.3.9/templates/id/add-printer.tmpl
--- cups-1.3.9~/templates/id/add-printer.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/id/add-rss-subscription.tmpl cups-1.3.9/templates/id/add-rss-subscription.tmpl
--- cups-1.3.9~/templates/id/add-rss-subscription.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/add-rss-subscription.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">Tambah Berlangganan RSS</H2>
diff -urNad cups-1.3.9~/templates/id/admin.tmpl cups-1.3.9/templates/id/admin.tmpl
--- cups-1.3.9~/templates/id/admin.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -53,6 +53,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Pengaturan Dasar <I>Server</I>:</B></P>
 
diff -urNad cups-1.3.9~/templates/id/choose-device.tmpl cups-1.3.9/templates/id/choose-device.tmpl
--- cups-1.3.9~/templates/id/choose-device.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/id/choose-make.tmpl cups-1.3.9/templates/id/choose-make.tmpl
--- cups-1.3.9~/templates/id/choose-make.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/id/choose-model.tmpl cups-1.3.9/templates/id/choose-model.tmpl
--- cups-1.3.9~/templates/id/choose-model.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/id/choose-serial.tmpl cups-1.3.9/templates/id/choose-serial.tmpl
--- cups-1.3.9~/templates/id/choose-serial.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/id/choose-uri.tmpl cups-1.3.9/templates/id/choose-uri.tmpl
--- cups-1.3.9~/templates/id/choose-uri.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/id/edit-config.tmpl cups-1.3.9/templates/id/edit-config.tmpl
--- cups-1.3.9~/templates/id/edit-config.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">Berkas Konfigurasi <i>Server</i></H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/id/job-move.tmpl cups-1.3.9/templates/id/job-move.tmpl
--- cups-1.3.9~/templates/id/job-move.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/id/modify-class.tmpl cups-1.3.9/templates/id/modify-class.tmpl
--- cups-1.3.9~/templates/id/modify-class.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Mengubah Kelas {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/id/modify-printer.tmpl cups-1.3.9/templates/id/modify-printer.tmpl
--- cups-1.3.9~/templates/id/modify-printer.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/id/samba-export.tmpl cups-1.3.9/templates/id/samba-export.tmpl
--- cups-1.3.9~/templates/id/samba-export.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Mengekspor Pencetak melalui Samba</H2>
diff -urNad cups-1.3.9~/templates/id/set-printer-options-header.tmpl cups-1.3.9/templates/id/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/id/set-printer-options-header.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/id/users.tmpl cups-1.3.9/templates/id/users.tmpl
--- cups-1.3.9~/templates/id/users.tmpl	2008-06-16 13:50:42.000000000 -0400
+++ cups-1.3.9/templates/id/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/it/add-class.tmpl cups-1.3.9/templates/it/add-class.tmpl
--- cups-1.3.9~/templates/it/add-class.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Aggiungi classe</H2>
diff -urNad cups-1.3.9~/templates/it/add-printer.tmpl cups-1.3.9/templates/it/add-printer.tmpl
--- cups-1.3.9~/templates/it/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/it/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/it/admin.tmpl cups-1.3.9/templates/it/admin.tmpl
--- cups-1.3.9~/templates/it/admin.tmpl	2007-03-19 12:01:28.000000000 -0400
+++ cups-1.3.9/templates/it/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -59,6 +59,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Impostazioni di base del server:</B></P>
 
diff -urNad cups-1.3.9~/templates/it/choose-device.tmpl cups-1.3.9/templates/it/choose-device.tmpl
--- cups-1.3.9~/templates/it/choose-device.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/it/choose-make.tmpl cups-1.3.9/templates/it/choose-make.tmpl
--- cups-1.3.9~/templates/it/choose-make.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/it/choose-model.tmpl cups-1.3.9/templates/it/choose-model.tmpl
--- cups-1.3.9~/templates/it/choose-model.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/it/choose-serial.tmpl cups-1.3.9/templates/it/choose-serial.tmpl
--- cups-1.3.9~/templates/it/choose-serial.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/it/choose-uri.tmpl cups-1.3.9/templates/it/choose-uri.tmpl
--- cups-1.3.9~/templates/it/choose-uri.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/it/edit-config.tmpl cups-1.3.9/templates/it/edit-config.tmpl
--- cups-1.3.9~/templates/it/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/it/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">File di configurazione del server</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/it/job-move.tmpl cups-1.3.9/templates/it/job-move.tmpl
--- cups-1.3.9~/templates/it/job-move.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/it/modify-class.tmpl cups-1.3.9/templates/it/modify-class.tmpl
--- cups-1.3.9~/templates/it/modify-class.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Modifica classe {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/it/modify-printer.tmpl cups-1.3.9/templates/it/modify-printer.tmpl
--- cups-1.3.9~/templates/it/modify-printer.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/it/samba-export.tmpl cups-1.3.9/templates/it/samba-export.tmpl
--- cups-1.3.9~/templates/it/samba-export.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Esporta stampanti su Samba</H2>
diff -urNad cups-1.3.9~/templates/it/set-printer-options-header.tmpl cups-1.3.9/templates/it/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/it/set-printer-options-header.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/it/users.tmpl cups-1.3.9/templates/it/users.tmpl
--- cups-1.3.9~/templates/it/users.tmpl	2006-11-16 08:33:33.000000000 -0500
+++ cups-1.3.9/templates/it/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/ja/add-class.tmpl cups-1.3.9/templates/ja/add-class.tmpl
--- cups-1.3.9~/templates/ja/add-class.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">クラスの追加</H2>
diff -urNad cups-1.3.9~/templates/ja/add-printer.tmpl cups-1.3.9/templates/ja/add-printer.tmpl
--- cups-1.3.9~/templates/ja/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/ja/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/ja/add-rss-subscription.tmpl cups-1.3.9/templates/ja/add-rss-subscription.tmpl
--- cups-1.3.9~/templates/ja/add-rss-subscription.tmpl	2007-10-10 18:56:24.000000000 -0400
+++ cups-1.3.9/templates/ja/add-rss-subscription.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">RSS 購読を追加</H2>
diff -urNad cups-1.3.9~/templates/ja/admin.tmpl cups-1.3.9/templates/ja/admin.tmpl
--- cups-1.3.9~/templates/ja/admin.tmpl	2007-10-10 18:56:24.000000000 -0400
+++ cups-1.3.9/templates/ja/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -53,6 +53,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>基本サーバ設定:</B></P>
 
diff -urNad cups-1.3.9~/templates/ja/choose-device.tmpl cups-1.3.9/templates/ja/choose-device.tmpl
--- cups-1.3.9~/templates/ja/choose-device.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/ja/choose-make.tmpl cups-1.3.9/templates/ja/choose-make.tmpl
--- cups-1.3.9~/templates/ja/choose-make.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/ja/choose-model.tmpl cups-1.3.9/templates/ja/choose-model.tmpl
--- cups-1.3.9~/templates/ja/choose-model.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/ja/choose-serial.tmpl cups-1.3.9/templates/ja/choose-serial.tmpl
--- cups-1.3.9~/templates/ja/choose-serial.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/ja/choose-uri.tmpl cups-1.3.9/templates/ja/choose-uri.tmpl
--- cups-1.3.9~/templates/ja/choose-uri.tmpl	2006-03-18 07:56:48.000000000 -0500
+++ cups-1.3.9/templates/ja/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/ja/edit-config.tmpl cups-1.3.9/templates/ja/edit-config.tmpl
--- cups-1.3.9~/templates/ja/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/ja/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">サーバ設定ファイル</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/ja/job-move.tmpl cups-1.3.9/templates/ja/job-move.tmpl
--- cups-1.3.9~/templates/ja/job-move.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/ja/modify-class.tmpl cups-1.3.9/templates/ja/modify-class.tmpl
--- cups-1.3.9~/templates/ja/modify-class.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">クラス {printer_name} の変更</H2>
diff -urNad cups-1.3.9~/templates/ja/modify-printer.tmpl cups-1.3.9/templates/ja/modify-printer.tmpl
--- cups-1.3.9~/templates/ja/modify-printer.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/ja/samba-export.tmpl cups-1.3.9/templates/ja/samba-export.tmpl
--- cups-1.3.9~/templates/ja/samba-export.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">プリンタを Samba にエキスポート</H2>
diff -urNad cups-1.3.9~/templates/ja/users.tmpl cups-1.3.9/templates/ja/users.tmpl
--- cups-1.3.9~/templates/ja/users.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/ja/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/job-move.tmpl cups-1.3.9/templates/job-move.tmpl
--- cups-1.3.9~/templates/job-move.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/modify-class.tmpl cups-1.3.9/templates/modify-class.tmpl
--- cups-1.3.9~/templates/modify-class.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Modify Class {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/modify-printer.tmpl cups-1.3.9/templates/modify-printer.tmpl
--- cups-1.3.9~/templates/modify-printer.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/pl/add-class.tmpl cups-1.3.9/templates/pl/add-class.tmpl
--- cups-1.3.9~/templates/pl/add-class.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Dodaj klasę</H2>
diff -urNad cups-1.3.9~/templates/pl/add-printer.tmpl cups-1.3.9/templates/pl/add-printer.tmpl
--- cups-1.3.9~/templates/pl/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/pl/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/pl/admin.tmpl cups-1.3.9/templates/pl/admin.tmpl
--- cups-1.3.9~/templates/pl/admin.tmpl	2007-03-19 12:01:28.000000000 -0400
+++ cups-1.3.9/templates/pl/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -57,6 +57,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Podstawowe ustawienia serwera:</B></P>
 
diff -urNad cups-1.3.9~/templates/pl/choose-device.tmpl cups-1.3.9/templates/pl/choose-device.tmpl
--- cups-1.3.9~/templates/pl/choose-device.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/pl/choose-make.tmpl cups-1.3.9/templates/pl/choose-make.tmpl
--- cups-1.3.9~/templates/pl/choose-make.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/pl/choose-model.tmpl cups-1.3.9/templates/pl/choose-model.tmpl
--- cups-1.3.9~/templates/pl/choose-model.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/pl/choose-serial.tmpl cups-1.3.9/templates/pl/choose-serial.tmpl
--- cups-1.3.9~/templates/pl/choose-serial.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/pl/choose-uri.tmpl cups-1.3.9/templates/pl/choose-uri.tmpl
--- cups-1.3.9~/templates/pl/choose-uri.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/pl/edit-config.tmpl cups-1.3.9/templates/pl/edit-config.tmpl
--- cups-1.3.9~/templates/pl/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/pl/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">Plik Konfiguracji Serwera</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/pl/job-move.tmpl cups-1.3.9/templates/pl/job-move.tmpl
--- cups-1.3.9~/templates/pl/job-move.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/pl/modify-class.tmpl cups-1.3.9/templates/pl/modify-class.tmpl
--- cups-1.3.9~/templates/pl/modify-class.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Zmodyfikuj klasę {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/pl/modify-printer.tmpl cups-1.3.9/templates/pl/modify-printer.tmpl
--- cups-1.3.9~/templates/pl/modify-printer.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/pl/samba-export.tmpl cups-1.3.9/templates/pl/samba-export.tmpl
--- cups-1.3.9~/templates/pl/samba-export.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Wyeksportuj drukarki do Samby</H2>
diff -urNad cups-1.3.9~/templates/pl/set-printer-options-header.tmpl cups-1.3.9/templates/pl/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/pl/set-printer-options-header.tmpl	2006-04-22 00:05:45.000000000 -0400
+++ cups-1.3.9/templates/pl/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/pl/users.tmpl cups-1.3.9/templates/pl/users.tmpl
--- cups-1.3.9~/templates/pl/users.tmpl	2006-05-15 15:05:22.000000000 -0400
+++ cups-1.3.9/templates/pl/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/samba-export.tmpl cups-1.3.9/templates/samba-export.tmpl
--- cups-1.3.9~/templates/samba-export.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Export Printers to Samba</H2>
diff -urNad cups-1.3.9~/templates/set-printer-options-header.tmpl cups-1.3.9/templates/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/set-printer-options-header.tmpl	2005-12-15 17:03:40.000000000 -0500
+++ cups-1.3.9/templates/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/sv/add-class.tmpl cups-1.3.9/templates/sv/add-class.tmpl
--- cups-1.3.9~/templates/sv/add-class.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Lägg till klass</H2>
diff -urNad cups-1.3.9~/templates/sv/add-printer.tmpl cups-1.3.9/templates/sv/add-printer.tmpl
--- cups-1.3.9~/templates/sv/add-printer.tmpl	2007-02-10 14:37:59.000000000 -0500
+++ cups-1.3.9/templates/sv/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {device_uri?<INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}">:}
 
diff -urNad cups-1.3.9~/templates/sv/admin.tmpl cups-1.3.9/templates/sv/admin.tmpl
--- cups-1.3.9~/templates/sv/admin.tmpl	2007-03-19 12:01:28.000000000 -0400
+++ cups-1.3.9/templates/sv/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -59,6 +59,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>Grundläggande serverinställningar:</B></P>
 
diff -urNad cups-1.3.9~/templates/sv/choose-device.tmpl cups-1.3.9/templates/sv/choose-device.tmpl
--- cups-1.3.9~/templates/sv/choose-device.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/sv/choose-make.tmpl cups-1.3.9/templates/sv/choose-make.tmpl
--- cups-1.3.9~/templates/sv/choose-make.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/sv/choose-model.tmpl cups-1.3.9/templates/sv/choose-model.tmpl
--- cups-1.3.9~/templates/sv/choose-model.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/sv/choose-serial.tmpl cups-1.3.9/templates/sv/choose-serial.tmpl
--- cups-1.3.9~/templates/sv/choose-serial.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/sv/choose-uri.tmpl cups-1.3.9/templates/sv/choose-uri.tmpl
--- cups-1.3.9~/templates/sv/choose-uri.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/sv/edit-config.tmpl cups-1.3.9/templates/sv/edit-config.tmpl
--- cups-1.3.9~/templates/sv/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/sv/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">Serverkonfigurationsfil</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/sv/job-move.tmpl cups-1.3.9/templates/sv/job-move.tmpl
--- cups-1.3.9~/templates/sv/job-move.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/sv/modify-class.tmpl cups-1.3.9/templates/sv/modify-class.tmpl
--- cups-1.3.9~/templates/sv/modify-class.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">Modifiera klass {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/sv/modify-printer.tmpl cups-1.3.9/templates/sv/modify-printer.tmpl
--- cups-1.3.9~/templates/sv/modify-printer.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/sv/samba-export.tmpl cups-1.3.9/templates/sv/samba-export.tmpl
--- cups-1.3.9~/templates/sv/samba-export.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Exportera skrivare till Samba</H2>
diff -urNad cups-1.3.9~/templates/sv/set-printer-options-header.tmpl cups-1.3.9/templates/sv/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/sv/set-printer-options-header.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/sv/users.tmpl cups-1.3.9/templates/sv/users.tmpl
--- cups-1.3.9~/templates/sv/users.tmpl	2006-04-17 10:50:45.000000000 -0400
+++ cups-1.3.9/templates/sv/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/users.tmpl cups-1.3.9/templates/users.tmpl
--- cups-1.3.9~/templates/users.tmpl	2006-03-03 21:00:43.000000000 -0500
+++ cups-1.3.9/templates/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -urNad cups-1.3.9~/templates/zh_TW/add-class.tmpl cups-1.3.9/templates/zh_TW/add-class.tmpl
--- cups-1.3.9~/templates/zh_TW/add-class.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/add-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">加入分類</H2>
diff -urNad cups-1.3.9~/templates/zh_TW/add-printer.tmpl cups-1.3.9/templates/zh_TW/add-printer.tmpl
--- cups-1.3.9~/templates/zh_TW/add-printer.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/add-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">加入新的印表機</H2>
diff -urNad cups-1.3.9~/templates/zh_TW/admin.tmpl cups-1.3.9/templates/zh_TW/admin.tmpl
--- cups-1.3.9~/templates/zh_TW/admin.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/admin.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -59,6 +59,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 <P><B>基本伺服器設定值：</B></P>
 
diff -urNad cups-1.3.9~/templates/zh_TW/choose-device.tmpl cups-1.3.9/templates/zh_TW/choose-device.tmpl
--- cups-1.3.9~/templates/zh_TW/choose-device.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/choose-device.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/zh_TW/choose-make.tmpl cups-1.3.9/templates/zh_TW/choose-make.tmpl
--- cups-1.3.9~/templates/zh_TW/choose-make.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/choose-make.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/zh_TW/choose-model.tmpl cups-1.3.9/templates/zh_TW/choose-model.tmpl
--- cups-1.3.9~/templates/zh_TW/choose-model.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/choose-model.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/zh_TW/choose-serial.tmpl cups-1.3.9/templates/zh_TW/choose-serial.tmpl
--- cups-1.3.9~/templates/zh_TW/choose-serial.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/choose-serial.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/zh_TW/choose-uri.tmpl cups-1.3.9/templates/zh_TW/choose-uri.tmpl
--- cups-1.3.9~/templates/zh_TW/choose-uri.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/choose-uri.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="{?printer_location}">
diff -urNad cups-1.3.9~/templates/zh_TW/edit-config.tmpl cups-1.3.9/templates/zh_TW/edit-config.tmpl
--- cups-1.3.9~/templates/zh_TW/edit-config.tmpl	2007-07-24 19:47:12.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/edit-config.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -8,7 +8,7 @@
 <H2 CLASS="title">伺服器配置檔案</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -urNad cups-1.3.9~/templates/zh_TW/job-move.tmpl cups-1.3.9/templates/zh_TW/job-move.tmpl
--- cups-1.3.9~/templates/zh_TW/job-move.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/job-move.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -urNad cups-1.3.9~/templates/zh_TW/modify-class.tmpl cups-1.3.9/templates/zh_TW/modify-class.tmpl
--- cups-1.3.9~/templates/zh_TW/modify-class.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/modify-class.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <H2 CLASS="title">修改分類 {printer_name}</H2>
diff -urNad cups-1.3.9~/templates/zh_TW/modify-printer.tmpl cups-1.3.9/templates/zh_TW/modify-printer.tmpl
--- cups-1.3.9~/templates/zh_TW/modify-printer.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/modify-printer.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {?device_uri=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_DEVICE_URI" VALUE="{device_uri}">}
 {?printer_make_and_model=?:<INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{printer_make_and_model}">}
diff -urNad cups-1.3.9~/templates/zh_TW/samba-export.tmpl cups-1.3.9/templates/zh_TW/samba-export.tmpl
--- cups-1.3.9~/templates/zh_TW/samba-export.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/samba-export.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -10,6 +10,7 @@
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">匯出印表機至 Samba</H2>
diff -urNad cups-1.3.9~/templates/zh_TW/set-printer-options-header.tmpl cups-1.3.9/templates/zh_TW/set-printer-options-header.tmpl
--- cups-1.3.9~/templates/zh_TW/set-printer-options-header.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/set-printer-options-header.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,3 +1,4 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
diff -urNad cups-1.3.9~/templates/zh_TW/users.tmpl cups-1.3.9/templates/zh_TW/users.tmpl
--- cups-1.3.9~/templates/zh_TW/users.tmpl	2007-05-08 15:48:20.000000000 -0400
+++ cups-1.3.9/templates/zh_TW/users.tmpl	2010-06-15 09:40:57.000000000 -0400
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
