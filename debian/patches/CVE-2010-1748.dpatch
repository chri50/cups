#! /bin/sh /usr/share/dpatch/dpatch-run
# Description: fix web interface memory disclosure
# From: Drew Yao

@DPATCH@
diff -urNad cups-1.3.9~/cgi-bin/var.c cups-1.3.9/cgi-bin/var.c
--- cups-1.3.9~/cgi-bin/var.c	2010-06-15 09:42:03.000000000 -0400
+++ cups-1.3.9/cgi-bin/var.c	2010-06-15 09:42:07.000000000 -0400
@@ -1103,6 +1103,9 @@
 	    * Read the hex code...
 	    */
 
+            if (!isxdigit(data[1] & 255) || !isxdigit(data[2] & 255))
+	      return (0);
+
             if (s < (value + sizeof(value) - 1))
 	    {
               data ++;
