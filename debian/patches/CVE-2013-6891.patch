Description: fix information disclosure via lppasswd binary
Origin: backported from 1.7.1
Bug: https://www.cups.org/str.php?L4319

diff -Naurp cups-1.7.0/cups/usersys.c cups-1.7.1/cups/usersys.c
--- cups-1.7.0/cups/usersys.c	2013-07-10 10:08:39.000000000 -0400
+++ cups-1.7.1/cups/usersys.c	2014-01-08 11:00:25.000000000 -0500
@@ -885,7 +878,13 @@ _cupsSetDefaults(void)
   if (cg->encryption == (http_encryption_t)-1 || !cg->server[0] ||
       !cg->user[0] || !cg->ipp_port)
   {
+#  ifdef HAVE_GETEUID
+    if ((geteuid() == getuid() || !getuid()) && getegid() == getgid() && (home = getenv("HOME")) != NULL)
+#  elif !defined(WIN32)
+    if (getuid() && (home = getenv("HOME")) != NULL)
+#  else
     if ((home = getenv("HOME")) != NULL)
+#  endif /* HAVE_GETEUID */
     {
      /*
       * Look for ~/.cups/client.conf...
