Description: fix information disclosure via lppasswd binary
Origin: backported from 1.7.1
Bug: https://www.cups.org/str.php?L4319

Index: cups-1.6.1/cups/usersys.c
===================================================================
--- cups-1.6.1.orig/cups/usersys.c	2014-01-14 10:17:49.630517852 -0500
+++ cups-1.6.1/cups/usersys.c	2014-01-14 10:17:49.626517852 -0500
@@ -785,7 +785,13 @@
   if (cg->encryption == (http_encryption_t)-1 || !cg->server[0] ||
       !cg->user[0] || !cg->ipp_port)
   {
+#  ifdef HAVE_GETEUID
+    if ((geteuid() == getuid() || !getuid()) && getegid() == getgid() && (home = getenv("HOME")) != NULL)
+#  elif !defined(WIN32)
+    if (getuid() && (home = getenv("HOME")) != NULL)
+#  else
     if ((home = getenv("HOME")) != NULL)
+#  endif /* HAVE_GETEUID */
     {
      /*
       * Look for ~/.cups/client.conf...
